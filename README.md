# 按键精灵 - Windows 11自动化工具

一个适配最新版Windows 11的按键精灵程序，可以记录和重放键盘鼠标操作，帮助自动化重复性任务。

## 功能特点

- 记录键盘和鼠标操作
- 重放记录的操作
- 保存和加载脚本
- 设置执行次数和间隔
- 编辑脚本
- 热键支持

## 安装要求

- Python 3.6+
- 以下Python库：
  - pyautogui
  - keyboard
  - pynput
  - customtkinter

可以使用以下命令安装所需库：

```
pip install pyautogui keyboard pynput customtkinter
```

## 使用方法

1. 运行主程序：

```
python main.py
```

2. 使用界面上的按钮进行操作：
   - 点击"开始记录"按钮开始记录操作
   - 点击"停止记录"按钮停止记录
   - 点击"开始播放"按钮重放脚本
   - 点击"停止播放"按钮停止重放
   - 使用"新建"、"打开"、"保存"和"另存为"按钮管理脚本文件

3. 设置执行参数：
   - 执行次数：设置脚本重复执行的次数
   - 间隔(秒)：设置每次重复执行之间的时间间隔

## 热键

- F9: 开始/停止记录
- F10: 开始/停止播放
- Ctrl+N: 新建脚本
- Ctrl+O: 打开脚本
- Ctrl+S: 保存脚本

## 脚本格式

脚本使用文本格式存储，每行表示一个操作，格式如下：

```
[时间戳] 操作类型: 参数
```

例如：

```
[0.500] KEY_PRESS: a
[0.700] KEY_RELEASE: a
[1.200] MOUSE_MOVE: 500, 300
[1.500] MOUSE_DOWN: left at 500, 300
[1.700] MOUSE_UP: left at 500, 300
```

## 安全提示

- 使用按键精灵时请注意，某些应用程序可能会将自动化操作视为可疑行为
- 在重要的应用程序或网站上使用前，请确保了解相关使用政策
- 播放脚本时，可以将鼠标移动到屏幕左上角来紧急停止操作（PyAutoGUI的安全功能）

## 故障排除

- 如果脚本无法正常播放，请检查：
  - 是否有足够的权限
  - 目标窗口是否处于前台
  - 脚本格式是否正确
  - 是否有特殊按键无法模拟

## 开发说明

程序由以下几个主要模块组成：

- `main.py`: 主程序入口
- `gui.py`: 图形用户界面
- `recorder.py`: 记录键盘和鼠标操作
- `player.py`: 重放记录的操作
- `script_manager.py`: 脚本管理（保存、加载等）
